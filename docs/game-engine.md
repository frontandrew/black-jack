# Игровой движок

## Механика игры

Игровой движок Blackjack реализован с использованием React и Redux для управления состоянием игры. 
Здесь описаны компоненты и логика, используемые для создания игрового процесса.

### Основные компоненты

1. **GameCanvas (view.tsx)**:
   - Компонент, отвечающий за отрисовку игрового процесса на `<canvas>`.
   - Использует `useEffect` для перерисовки при изменении состояния игры.
   - Функции `drawGame` и `drawCard` рисуют текущие руки игрока и дилера, а также значения рук и деньги игрока.

2. **Redux Slice (model.ts)**:
   - Управляет состоянием игры с использованием `createSlice` из `@reduxjs/toolkit`.
   - Инициализация состояния игры в `initialState`.
   - Редьюсеры для действий в игре: `startGame`, `drawPlayerCard`, `revealDealerCard`, `drawDealerCard`, `playerStand`, `updatePlayerMoney`, `resetGame`, `newGame`.

3. **Типы данных (types.ts)**:
   - Определены интерфейсы `Card` и `GameState` для типизации данных.

4. **Утилиты (utils.ts)**:
   - Вспомогательные функции для создания колоды карт, ее перемешивания и подсчета очков.

### Логика игры

1. **Начало игры (startGame)**:
   - Инициализация состояния игры: очистка рук игрока и дилера, сброс флагов состояния.
   - Раздача двух карт игроку и дилеру (одна карта дилера скрыта).
   - Проверка на наличие "Blackjack" у игрока.

2. **Ход игрока (drawPlayerCard)**:
   - Добавление карты игроку при каждом вызове.
   - Проверка на "перебор" (bust) и завершение игры, если сумма очков превышает 21 (дилер не добирает).
   - Автоматический переход к завершению хода, если игрок набрал 21 очко.

3. **Ход дилера (drawDealerCard)**:
   - Добавление карт дилеру, пока сумма его очков не достигнет 17.
   - Переход к завершению хода дилера, если у игрока `stand`.
   - Определение результата игры (победа, поражение, ничья) на основе очков игрока и дилера.

4. **Завершение хода игрока (playerStand)**:
   - Установка флага `playerStand` и начало хода дилера.
   - Открытие скрытой карты дилера и добор карт до достижения 17 очков.

5. **Обновление денег игрока (updatePlayerMoney)**:
   - Изменение баланса игрока на основе результата игры.

6. **Сброс игры для новой раздачи (resetGame)**:
   - Сброс текущего состояния игры до инициализации `init`.

7. **Новая игра (newGame)**:
   - Сброс текущего состояния игры до инициализации `init`.
   - Очистка массивов рук игрока и дилера.
   - Создание и перемешивание новой колоды карт.

### ToDo

- Реализовать механику ставки любого номинала (не только $10).
- Сделать дилера умнее, чтобы он принимал более сложные решения.
- Добавить возможность участия нескольких игроков или нескольких одновременных ставок.
- Возможность выхода со стола с выигрышем и сообщение с суммой выигрыша.
- Добавить переменную для вывода сообщения в игре ("win", "lose", "tie", "blackjack" и др.).

Игровой движок обеспечивает основу для создания увлекательной игры в Blackjack. Использование инструментов React и Redux делает приложение гибким и расширяемым для будущих улучшений и добавлений.